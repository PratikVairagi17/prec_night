@echo off
REM Windows 11 KMS Key Management - interactive batch
REM Save as .bat and run as administrator. Add your purchased keys when prompted.

:: Require admin
net session >nul 2>&1
if %errorlevel% NEQ 0 (
    echo Administrative privileges required. Relaunching as admin...
    powershell -Command "Start-Process -FilePath '%~f0' -Verb RunAs"
    exit /b
)

:menu
cls
echo === Windows 11 KMS Key Management ===
echo.
echo 1) Install product key
echo 2) Uninstall product key
echo 3) Set KMS host
echo 4) Clear KMS host
echo 5) Activate now (ATO)
echo 6) Show license summary (DLI)
echo 7) Show detailed license info (DLV)
echo 8) Show license expiration (XPR)
echo 9) Exit
echo.
set /p choice=Choose an option [1-9]:

if "%choice%"=="1" goto install_key
if "%choice%"=="2" goto uninstall_key
if "%choice%"=="3" goto set_kms
if "%choice%"=="4" goto clear_kms
if "%choice%"=="5" goto activate
if "%choice%"=="6" goto dli
if "%choice%"=="7" goto dlv
if "%choice%"=="8" goto xpr
if "%choice%"=="9" goto eof
goto menu

:install_key
set /p KEY=Enter Windows product key (paste your purchased key): 
echo Installing product key...
cscript //nologo "%windir%\system32\slmgr.vbs" /ipk %KEY%
echo.
pause
goto menu

:uninstall_key
echo Uninstalling product key...
cscript //nologo "%windir%\system32\slmgr.vbs" /upk
echo.
pause
goto menu

:set_kms
set /p KMS=Enter KMS host (hostname[:port]): 
if "%KMS%"=="" (
    echo No KMS host entered.
) else (
    echo Setting KMS host to %KMS%...
    cscript //nologo "%windir%\system32\slmgr.vbs" /skms %KMS%
)
echo.
pause
goto menu

:clear_kms
echo Clearing KMS host...
cscript //nologo "%windir%\system32\slmgr.vbs" /ckms
echo.
pause
goto menu

:activate
echo Attempting activation...
cscript //nologo "%windir%\system32\slmgr.vbs" /ato
echo.
pause
goto menu

:dli
echo License summary:
cscript //nologo "%windir%\system32\slmgr.vbs" /dli
echo.
pause
goto menu

:dlv
echo Detailed license info:
cscript //nologo "%windir%\system32\slmgr.vbs" /dlv
echo.
pause
goto menu

:xpr
echo License expiration:
cscript //nologo "%windir%\system32\slmgr.vbs" /xpr
echo.
pause
goto menu

:eof
echo Exiting.
exit /b